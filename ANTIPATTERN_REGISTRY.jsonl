{"id":"AP-001","date":"2026-02-28","pattern":"task_marker_premature_x","description":"完了確認前に[x]マーカーを付与した。ユーザー最終承認前に'Completed'ステータスを設定した","trigger":"Phase Verificationや検証フェーズが進行中であるにもかかわらず[x]を付与","fix":"ユーザーが[x]を承認するまで必ず[/]を維持する。active_task.json の status:Completed は人間承認後のみ","severity":"high","related_files":["task.md",".agent/session/active_task.json",".agent/scripts/sync_governance.js"],"expires_days":null,"source":"会話 a9865040","human_note":"AIが完了を急ぐ心理的傾向により、ユーザー最終確認前に[x]を付与した。[/]は着手中、[x]は人間承認後のみ許容。"}
{"id":"AP-002","date":"2026-02-28","pattern":"partial_edit_variable_loss","description":"replace_file_contentで広範囲を置換した結果、既存の定数・関数が消去されシンタックスエラーが発生した","trigger":"TargetContentに広い範囲のコードを指定し、ReplacementContentで一部の初期化コードを省略した","fix":"広範囲の編集前に必ずファイル全文を確認する。定数(const)・関数定義が削除されないことを確認してから置換する","severity":"high","related_files":[".agent/scripts/pre_flight.js",".agent/scripts/reflect.js"],"expires_days":null,"source":"会話 a9865040","human_note":"部分編集ではなく必要に応じて全ファイル再作成を選択すること。既存ファイルのview後に編集を行うこと。"}
{"id":"AP-003","date":"2026-02-28","pattern":"powershell_add_content_cp932","description":"PowerShellのAdd-ContentがデフォルトCP932でAMPLOG.jsonlに書き込みUTF-8 JSONが壊れた","trigger":"Add-Content で全角文字を含む文字列をJSONLに追記した","fix":"AMPLOGへの追記は必ず Node.js (fs.appendFileSync, encoding: utf8) か Out-File -Encoding UTF8 を使うこと","severity":"high","related_files":["AMPLOG.jsonl"],"expires_days":null,"source":"human_cli","human_note":"Add-ContentのデフォルトエンコーディングはCP932。絶対にNode経由で書き込むこと"}
