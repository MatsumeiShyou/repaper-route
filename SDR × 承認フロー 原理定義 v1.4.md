SDR × 承認フロー 原理定義 v1.4

本書は「坪野谷紙業厚木事業所 DX設計憲法」に従属する。
本書の記載内容は、憲法の解釈および具体化を目的とするものであり、
憲法に反する解釈・実装・運用を正当化するものではない。
序文
承認フローは、業務システムにおいて最も誤解されやすく、かつ最も破壊力の高い概念である。このフローの設計を誤ることは、単なる機能不全を意味しない。それは「誰が、いつ、なぜ判断したのか」という、システムの根幹をなす記録の完全性を破壊し、SDRモデルそのものを思想のレベルで崩壊させる行為に他ならない。
多くの失敗したシステムは、承認を誤って扱うことで「誰が、いつ、なぜ判断したのか」を失い、SDRモデルを破壊してきた。本原理定義は、承認フローがSDRモデルを破壊しないための交渉不能な境界線を定義するものである。本書は、承認という概念の正しい位置づけと、それがシステムの中核データとどのように関わるべきかの厳格なルールを定める、思想の防衛線である。
したがって、本原理原則の力を発揮させるためにも、まず本書の位置づけと権限を明確に定義することから始める。
--------------------------------------------------------------------------------
1. 本文書の位置づけ
原理原則は、その適用範囲と権限を明確に定義することによってのみ、その力を発揮する。本セクションは、この文書がSDRモデル全体の思想の中でどのような役割を担い、何に責任を持ち、何をスコープ外とするかを明示することで、本書が持つ権威の源泉とその境界を確立する。
本書は以下の文書に従属する。
* 坪野谷紙業厚木事業所 DX設計憲法 Ver.2.0
本書の役割は以下に限定される。
1. 承認が State / Decision / Reason のどれにも属さない理由を定義する
2. 承認がいつ・どのように Decision に関与できるかを明示する
3. 承認を誤って実装した場合の破壊点を事前に封じる
※業務別の承認段数、UI、通知、期限などはすべてスコープ外である。
これらの定義により、本書は特定の業務フローではなく、あらゆる業務フローの基盤となる不変の思想を規定する。この思想の理解こそが、SDRモデルにおける承認の正しい実装への唯一の道である。
続いて、その思想の根幹をなす「承認は中核データ概念ではない」という基本原則を定義する。
--------------------------------------------------------------------------------
2. 基本原則：承認は第四の概念ではない
システムアーキテクチャにおける最大の過ちは、「承認」をState（状態）、Decision（判断）、Reason（理由）に並ぶ第四の永続的な概念として扱ってしまうことである。本セクションでは、この致命的な誤解を根本から正す。承認とはデータモデルの一部ではなく、特定の判断（Decision）が生まれることを許可するための一時的な「関門」に過ぎないという、最も重要な基本原則をここに宣言する。
原則1 承認（Approval）は State / Decision / Reason のいずれでもない。
* 承認は「事実」ではない
* 承認は「判断」ではない
* 承認は「理由」ではない
* 承認とは、Decisionが生成される条件を制御するための一時的な関門である
原則2 承認それ自体が State として永続化されてはならない。
禁止事項
* approved / rejected / pending を State として保存すること
* 「承認済み状態」「未承認状態」という永続的概念の導入
* Stateの遷移条件として承認状態を直接参照する設計
Stateはあくまで判断の結果として生じた事実のスナップショットである。
この原則は、承認プロセスがシステムの状態を汚染することを防ぎ、判断の履歴を純粋に保つための防波堤となる。次のセクションでは、この原則に基づき、Decisionが生成されるプロセスと承認の正しい関係を具体的に定義する。
--------------------------------------------------------------------------------
3. Decision と承認の正しい関係
承認が「関門」であるならば、その関門を通過した結果として何が生まれるのかを正確に定義せねばならない。本セクションでは、承認という行為とDecision（判断）の生成が、不可分かつ厳格な因果関係にあることを明らかにする。Decisionは承認の「前」に存在するのではなく、承認というトリガーによって初めて「後」に生成される唯一無二の正史であると定義する。
原則3 Decisionは承認された瞬間に初めて存在する。 承認前のものは Decisionではない。 承認待ちの操作は「判断案」「申請」「提案」に過ぎない。
承認 = Decisionを生成するトリガー条件の一部
原則4（改訂：否認履歴の分離）
* 否認（却下）は Decision に含めない
* 承認前の申請・提案・操作はすべて DecisionProposals テーブル に格納される
* このテーブルには却下・保留を含む全ての人間の申請およびProposal、およびAIによる自動生成提案 が閉じ込められ、Decision正史には影響を与えない
* 承認されたProposalのみが、システムによって INSERT INTO Decision され、正史としてappend-onlyで保持される
理由
* Decisionは現実を変える意思決定であり、否認は「現実を変えない」という結果に過ぎない
* 正史の汚染を防ぐため、却下・保留はProposalテーブルに閉じ込め、Decisionテーブルには反映しない
この厳格な分離により、Decisionテーブルは「実行され、現実世界に影響を与えた判断」のみを記録する、汚染なき歴史書としての役割を全うする。そして、全てのDecisionには、その判断がなぜ下されたのかを示すReasonが必ず伴わなければならない。
--------------------------------------------------------------------------------
4. Reason と承認理由の関係
A Decision without a Reason is an orphan—an unaccountable artifact that poisons the historical record. しかし、承認プロセスは「なぜ承認したか（承認理由）」と「なぜその判断が下されたか（Reason）」という二つの概念の混同を招く、危険な可能性を内包している。本セクションは、この二つの概念の間に破られることのないファイアウォールを設置し、我々の判断履歴の完全性を保護する。
原則5 Reasonは Decision にのみ付随する。
* 承認理由は Reason ではない
* 却下理由も Reason ではない
* 承認プロセス中のコメント・補足・説明は、Decisionが生成されなければ履歴に残らない
原則6 承認理由と判断理由を混同してはならない。
* 「なぜ承認したか」 → 承認コメント
* 「なぜその操作を申請したか」 → Reasonではない
* Reasonは常に「なぜこの判断が下されたか」にのみ紐づく
これらの原則は、システムのログが「誰が最終的な判断責任を負うのか」を明確に記録するためのものである。次のセクションでは、この責任の原則が、例外的な操作においていかにして維持されるべきかを定義する。
--------------------------------------------------------------------------------
5. 強制操作・例外と承認
システムは理想的な業務フローを支援するが、現実は常に例外を伴う。承認フローが、こうした例外的な強制操作と組み合わさる時、責任の所在が曖昧になるという重大なリスクが生じる。本セクションの原則は、「判断の責任はただ一つの主体に帰属する」というSDRモデルの思想を守り抜くために存在する。この思想は、データ構造レベルでrequested_byとapproved_byフィールドを分離することで技術的に強制されており、本章ではその操作主体と責任主体の関係を原理として定義する。
原則7 判断の責任は判断主体にのみ帰属する。 SDRモデルにおいて、Decisionを生成した主体が責任主体である。この原則を明確化するため、以下の二つの主体を厳格に区別する。
* 判断主体 (Decision Subject)
* 承認を経てDecisionとなるProposalを起案した主体。
* Decisionの内容と、それに紐づくReasonに対する説明責任を負う、真の意思決定者である。
* 承認操作主体 (Approval Action Subject)
* Proposalを承認し、Decisionの生成を許可する操作を行った主体。
* その役割は、判断を許可する関門（ゲートキーパー）であり、判断の内容そのものを生成する者ではない。
禁止事項
* 「承認者がOKしたから責任は承認者」
* 「申請者と承認者の責任が曖-昧」
* 「承認フローに通ったから安全」
原則7.1 承認操作は責任の移譲ではない 承認操作主体による承認行為は、判断主体が持つ意思決定の責任を移譲するものではない。承認はあくまで手続き上の確認であり、Decisionの内容やReasonに対する説明責任を引き受ける行為ではない。「承認者＝責任者」という一般的な誤解は、原理レベルで明確に否定される。
原則8 強制操作は承認の有無に関わらず Decision として明示されなければならない。
* 承認付き強制操作
* 承認なし緊急操作
必須事項
* is_admin_forced 等の明示的区別
* Reasonの必須化
* 通常判断との差別化
これらの原則は、責任の所在を恒久的に保護する。そして現代において、この厳格なフレームワークにAIと自動化をどう組み込むかは、モデルの進化における最重要課題となる。
--------------------------------------------------------------------------------
6. AI・自動化と承認フロー
AIの統合は機能のアップデートではない。それは我々の設計憲法に対する修正条項の追加である。本セクションは、「AI Proposal モデル」を承認フローの原理に正式に組み込み、AIの役割を「ビジネスOS」の中に法的に位置づける。これにより、AIの力を活用しつつも、最も神聖な原則である「人間の最終判断権」が決して侵害されないことを保証する。AIには発言権（提案）が与えられるが、投票権（判断）は与えられない。AIの提案は、人間による提案と全く同じく、DecisionProposalsという受付カウンターに提出され、同じ人間による厳格な承認プロセスを経て初めて正史（Decision）に影響を与えうる。これは、AIを隔離された実験室から、統制された業務プロセスの一部へと正式に迎え入れるための憲章である。
6.1 用語の再定義：AI提案と人間の判断
AIの役割を正確に定義するためには、まず用語の共通理解を確立する必要がある。以下の表は、AI提案と人間の判断に関する誤解を解き、本原理における正しい定義を再確認するものである。
用語 誤解されやすい定義 正しい定義
AI Proposal AIが判断を自動で確定する 人間が意思決定するための材料・複数の選択肢・リスク警告を含む「提案」。DecisionProposal の一種として扱われる。
Decision AIの提案で自動生成される判断 人間による明示的な承認操作によって生成される「正史」の判断。AI提案をきっかけに生成されることもある。
Reason AIの補助コメント 人間がDecisionを確定した理由。AIの情報は参考にはなるが、Reasonそのものは必ず人間によって記録される正史。
6.2 AIの役割と責任境界（原則9の具体化）
本項では、AIと人間の役割分担を規定する原則9を具体的に解説する。
原則9
* AIは承認主体になれない
* AIは申請を生成できる
* AIは提案を最適化できる
* AIはDecisionを確定できない
* AIの出力はすべて承認対象以前の存在である
この原則に基づく具体的なプロセスは以下の通りである。まず、AIは業務データに基づき、最適化された計画案やリスク警告を含む提案（申請）を生成できる。この提案は、人間による申請と同様に**DecisionProposalsテーブルの一レコードとして記録され、「承認待ちの参考情報」として扱われる**。この提案が、システムの公式な歴史であるDecisionテーブルを直接変更することは、いかなる状況においても許可されない。権限を持つ人間がそのAI提案をレビューし、承認ボタンを押すという明示的な行為を行った瞬間にのみ、システムは新たなDecisionレコードを生成する。その際、requested_byフィールドはAIシステムを参照することが許されるが、最終的な責任の所在を明確にするapproved_byフィールドと、その判断の根拠であるReasonは、必ず承認操作主体である人間によって記録されなければならない。この統一的アプローチは、独立した「AI Proposal Log」という概念を意図的に廃し、全ての提案がその出自に関わらず、唯一かつ不変の承認プロセスに従うことを保証するものである。
6.3 UI/UXにおける原則：人間の判断権の保護
AIからの提案をユーザーに提示するインターフェースは、人間の最終判断権という大原則を守るための重要な制御点である。UI/UX設計においては、以下のルールが交渉不能な必須事項となる。
* 中立的・非誘導的な設計: UIは、AIの提案をあくまで選択肢の一つとして、客観的かつ中立的に提示しなければならない。
* 認知操作の禁止: 特定の選択肢を推奨するような色の強調や表示順の操作など、人間の自由な判断を誘導したり制限したりするデザインは固く禁じる。
* 人間の操作による確定: 「確定」や「承認」といった、システムの正史を変更する最終的なアクションは、必ず人間の明確な意思によるクリックやタップといった物理的な操作によってのみトリガーされなければならない。
6.4 判断理由の厳格な分離（原則6の補強）
原則6（承認理由と判断理由を混同してはならない）をAIの文脈で補強する。 AIが生成するリスク評価、信頼度スコア、推奨根拠といった情報は、非常に有用な参考情報であるが、それらは決して公式なReasonそのものではない。公式なReasonとは、あくまで「なぜその判断が下されたか」を記録する人間による歴史的証言である。したがって、AIが提示した補助情報を参考にしたとしても、最終的なDecisionに紐づくReasonは、必ず判断主体である人間自身の言葉で記録されなければならない。これにより、判断の責任がAIというブラックボックスに転嫁されることを防ぎ、説明責任の所在を恒久的に人間に留める。
6.5 将来構想：承認フローの進化ロードマップ
AIと承認フローの統合は、一度きりのイベントではなく、段階的に進化するプロセスである。以下にその進化のロードマップを示す。
1. Phase 1 (v1.0): 記録基盤の構築 人間によるDecisionとReasonの生成・記録プロセスを完全に確立し、不変の正史ログを構築することに集中する。
2. Phase 2 (v1.1): AI提案の導入 AIが複数の候補案を生成し、それらを**DecisionProposalsテーブルに投入する機能を実装する**。人間はこれらの提案をレビューし、承認することで初めてDecisionが生成される。Decisionの正史の不変性は厳格に維持される。
3. Phase 3 (v2.0): 提案の高度化 動的な再配車シミュレーションなど、より高度なAI提案機能を導入する。しかし、この段階においても、その提案を採用するか否かの最終的な意思決定権は、承認フローを通じて完全に人間に留保される。
6.6 自動承認の正しい解釈（原則10）
最後に、「自動承認」という言葉の誤解を解き、その正しい位置づけを定義する。自動承認は、判断そのものの自動化ではなく、事前に定義された低リスクな定型業務において、人間による承認操作を「省略」するショートカットに過ぎない。
原則10
* 自動承認は「承認の省略」であって「判断の自動化」ではない
* Decisionの主体は明確でなければならない
* Reasonは省略できない
* 人間の最終判断権が放棄されてはならない
これらの注意深く構築された原理を破ることは、システムに壊滅的な結果をもたらす。
--------------------------------------------------------------------------------
7. この原理を破ったときに起こること
本ドキュメントで定義された原理は、単なる設計ガイドラインではない。これは、システムの思想的な背骨である。これを破ることは、些細な設計ミスではなく、システムの信頼性、監査可能性、そしてデータ品質の完全な崩壊を意味する。その結果として起こることは、予測可能かつ壊滅的である。
* 承認ログと判断ログが混在する
* 責任の所在が不明確になる
* 判断の責任主体が承認操作主体に誤って転嫁され、本来の申請者の説明責任が失われる。
* 否認・保留がDecision履歴を汚染する
* AIが学習すべき「正しい判断」が失われる
* 承認フローが目的化し、業務が停止する
* AIの提案が、人間の承認を経ずにDecision正史として記録され、判断の責任主体が失われる。
設計ミスではなく思想の崩壊である。
--------------------------------------------------------------------------------
結語
ここに記された原則は、システムの未来を守るための契約である。
承認フローは、判断を遅らせるために存在するのではない。判断を守るために存在する。
SDRモデルにおいて、判断は資産であり、履歴は未来への契約である。承認はその契約を破壊しないための安全装置である。
--------------------------------------------------------------------------------
必須事項
* 否認・保留のProposalは DecisionProposals テーブル に格納し、Decisionテーブルには混入させない
* ReasonはDecisionに必ず付与する
* Decisionはappend-onlyで保持し、人間またはAIが生成したProposalから承認昇格されたもののみ正史として記録する